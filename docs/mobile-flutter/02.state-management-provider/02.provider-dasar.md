# Pengenalan State Management dengan Provider (ChangeNotifier)

---

## Pertanyaan Pemantik
Pada pertemuan sebelumnya kita melihat banyak masalah saat state dikelola sendiri di tiap halaman.

Pertanyaannya:  
- Bagaimana jika data disimpan di satu tempat saja?  
- Bagaimana jika semua halaman bisa membaca data yang sama?

---

## 1. Provider Itu Apa?  
Provider adalah **alat bantu** untuk:  
- menyimpan state di satu tempat  
- memberitahu UI saat data berubah  
- menghindari pengiriman data berulang-ulang antar halaman

Provider bukan sekadar library,
tetapi **cara berpikir mengelola data**.

---

## 2. Perumpamaan Provider
Bayangkan sekolah:  
- Data nilai siswa disimpan di ruang TU (Provider)  
- Guru dan wali kelas mengambil data dari TU  
- Jika nilai berubah, semua mendapat data terbaru

Tanpa Provider:  
- Setiap guru simpan nilai sendiri  
- Data mudah berbeda dan salah

---

## 3. ChangeNotifier
ChangeNotifier adalah class yang:  
- menyimpan data (state)  
- memberi tahu UI saat data berubah

Saat data berubah, kita memanggil:
```dart
notifyListeners();
```

Artinya:
"Hei, ada data berubah. UI silakan update."

---

## Tutorial Praktik (Langkah demi Langkah)

### 1. Menambahkan Dependency Provider
Buka pubspec.yaml dan tambahkan:

```yaml
dependencies:
  flutter:
    sdk: flutter
  provider: ^6.0.5
```

Jalankan:
```bash
flutter pub get
```

---

### 2. Membuat Provider (State)
Buat folder dan file:

```
lib/
 └── providers/
     └── cart_provider.dart
```

#### File: lib/providers/cart_provider.dart
```dart
import 'package:flutter/material.dart';

class CartProvider extends ChangeNotifier {
  int _count = 0;

  int get count => _count;

  void addItem() {
    _count++;
    notifyListeners();
  }
}
```

---

### 3. Mendaftarkan Provider di main.dart
Update file main.dart:

```dart
import 'package:flutter/material.dart';
import 'package:provider/provider.dart';
import 'providers/cart_provider.dart';
import 'routes/app_router.dart';

void main() {
  runApp(
    MultiProvider(
      providers: [
        ChangeNotifierProvider(create: (_) => CartProvider()),
      ],
      child: const MyApp(),
    ),
  );
}

class MyApp extends StatelessWidget {
  const MyApp({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp.router(
      debugShowCheckedModeBanner: false,
      title: 'SMK Product App',
      routerConfig: appRouter,
      theme: ThemeData(
        useMaterial3: true,
      ),
    );
  }
}
```

---

### 4. Menggunakan Provider di UI
Contoh penggunaan di HomePage.

Tambahkan import:
```dart
import 'package:provider/provider.dart';
import '../providers/cart_provider.dart';
```

Tambahkan widget berikut di HomePage:

```dart
Consumer<CartProvider>(
  builder: (context, cart, child) {
    return Column(
      children: [
        Text('Jumlah di Keranjang: ${cart.count}'),
        ElevatedButton(
          onPressed: () {
            cart.addItem();
          },
          child: const Text('Tambah ke Keranjang'),
        ),
      ],
    );
  },
)
```

Perhatikan:  
- UI tidak menyimpan data sendiri  
- UI hanya membaca data dari Provider

---

## Checklist Keberhasilan
- State disimpan di CartProvider
- UI tidak memiliki variabel state cart sendiri
- Data berubah otomatis tanpa setState manual
- notifyListeners dipanggil saat data berubah

---

## Studi Kasus  
Bayangkan aplikasi memiliki:  
- halaman Home  
- halaman Detail  
- halaman Keranjang

Diskusikan:  
- Kenapa data keranjang sebaiknya di Provider?  
- Apa yang terjadi jika data keranjang disimpan di masing-masing halaman?

---

## Tugas

### Tugas Level Dasar
1. Tambahkan method removeItem() di CartProvider  
2. Buat tombol untuk mengurangi jumlah item  
3. Pastikan UI otomatis ikut berubah

---

### Tugas Level Industri
1. Tambahkan state baru di CartProvider:  
   - totalHarga  
2. Setiap addItem, totalHarga ikut berubah  
3. Jangan hitung totalHarga di UI

---

## Refleksi
Jawab singkat:  
1. Apa perbedaan mengelola state dengan dan tanpa Provider?  
2. Kenapa notifyListeners penting?  
3. Kenapa logic sebaiknya tidak ditulis di UI?

---

## Penutup
Hari ini kalian mulai menggunakan Provider.

Ini adalah pondasi penting karena:  
- Provider akan dipakai untuk API  
- Provider akan dipakai untuk Firebase  
- Provider membantu kode tetap rapi

Pada pertemuan berikutnya, kita akan mengelola **state berbentuk list data** menggunakan Provider.
